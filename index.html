
<!--这个版本修改了，第一次左键点击后，才自动生成地雷的格子，避免第一次点击就点到雷的尴尬-->
<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }
        body{
            background-color: #aaa;
            /*background-image: url('daomei.jpg');*/
            background-size: cover;
        }
        .box{
            width: 600px;
            height: 450px;
            margin: 50px auto;
            border: 10px solid #000000;
        }
        .box ul li{
           list-style: none;
            float: left;
            width: 20px;
            height: 20px;
            border: 1px solid #ccc;
            box-sizing: border-box;
            background-color: green;
            line-height: 20px;
            text-align: center;
            color: blue;
            cursor: pointer;
        }
        .top {
            height: 50px;
            line-height: 50px;
        }
        .left {
            float: left;
            width: 50%;
            height: 50px;
            text-align: center;
            line-height: 40px;
        }
        .right {
            float: right;
            width: 50%;
            height: 50px;
            text-align: center;
            line-height: 40px;
        }
        .top b {
            font-size: 40px;
            color: red;
        }
        #payBox {
            width: 500px;
            height: 200px;
            background-color: #D33A31;
            color: #ffffff;
            font-size: 40px;
            text-align: center;
            line-height: 100px;
            position: fixed;
            /*top: 176px;*/
            left: 435px;
            border-radius: 30px;
            top: -100px;
            opacity: 0;
            z-index: -1;
        }
        #payBox button {
            padding: 10px;
            border-radius: 10px;
            font-family: "微软雅黑";
            font-size: 16px;
            color: #384445;
            cursor: pointer;
        }
        #payBox button:hover {
            background-color: #E6AB81;
        }
        #spread {
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: #464038;
            z-index: -2;
            top: 0;
            left: 0;
            opacity:0;
        }

    </style>
</head>
<body>
    <div class="box" id="box">
        <div class="top">
            <span class="left">剩余 <b id="laveLei"></b> 个雷</span>
            <span class="right">已用 <b id="timeUse">0</b> 秒</span>
        </div>
        <ul id="ul">
        </ul>
    </div>
    <div id="payBox">
        <p id="tishi"></p>
        <!--<button id="backShop">返回</button>-->
        <button id="closeCeng">再来一次</button>
    </div>
    <div id="spread">

    </div>
</body>
<script>
    // li标签的自定义属性备注
    // 1   aaa : 当前的li标签是否是雷
    // 2   bbb : li标签周围雷的个数
    // 3   ccc : 当前li标签被标记的状态
    // 4   ddd : 当前li标签被点击的状态
    // 5   eee : 当前li标签不是累
    var box =document.getElementById('box');
    var ul = document.getElementById('ul');
    var laveLei = document.getElementById('laveLei');
    var timeUse = document.getElementById('timeUse');
    var zheceng = document.getElementById('spread');
    var tanchuang = document.getElementById('payBox');
    var closeCeng = document.getElementById('closeCeng');
    var tishi = document.getElementById('tishi');
    closeCeng.onclick = function(){
        location.reload();
    }
    //取消系统默认的鼠标右击事件
    box.oncontextmenu = function(e){
        e.preventDefault();
    };
    //动态创建所有的小格子
    for(var i = 0;i<600;i++){
        var li = document.createElement('li');
        li.ccc = true;
        li.ddd = true;
        li.eee = true;
        ul.appendChild(li);
    }
    var arr = [];//存储生成的雷的li标签的索引
    var bool = true;//判断生成的雷的数量是否足够
    var abc;// 判断生成的雷的索引是否重复
    var num2 = 0;//储存当前li标签周围雷的数量
    var lave =50;//设定游戏的雷的数量
    var times = 0;//设置起始的时间
    var timeID ;
    var firstClick = true;
    // 动态的获取随机的雷的li标签索引
    laveLei.innerHTML = lave;
    var lis = ul.children;
    // 两个数组储存左右两边格子的索引
    var indexArr1 = [30,60,90,120,150,180,210,240,270,300,330,360,390,420,450,480,510,540];
    var indexArr2 = [59,89,119,149,179,209,239,269,299,329,359,389,419,449,479,509,539,569];
    // 遍历所有的li标签，如果不是雷，计算出它周围有多少个雷，并且把数量存在它的自定义属性bbb上
    // 给所有的li标签绑定鼠标左击和右击的事件
    for(var i = 0;i<lis.length;i++){
        lis[i].index = i;
        //给所有的格子添加鼠标点击和右击事件
        lis[i].onmousedown = function(e){
            if(e.button ==2){
                //鼠标右键事件
                //  变量的状态代表所有的雷都被找出且所有的非格子都被点出来
                var noleiAll = true;
                // 如果这个格子已经被点出来了，右击就不起效果
                if(!this.ddd){
                    return;
                }
                // 自定义属性表示，当前格子是否被标记的状态
                if(this.ccc){
                    this.style.backgroundColor  = 'red';
                    lave--;
                    laveLei.innerHTML = lave;
                    this.ccc = false;
                }else {
                    this.style.backgroundColor  = 'green';
                    lave++;
                    laveLei.innerHTML = lave;
                    this.ccc = true;
                }
                // 判断所有的格子是否已经被标记和点击
                for(var i = 0;i<lis.length;i++){
                    if(lis[i].aaa){
                        if(lis[i].ccc){
                            noleiAll  = false;
                            break;
                        }
                    }else{
                        if(lis[i].ddd){
                            noleiAll  = false;
                            break;
                        }
                    }
                }
                // 如果所有的雷都标记了，所有不是雷的格子都点出来了，游戏就结束了，玩家赢
                if(noleiAll){
                    tishi.innerHTML = '恭喜，你赢了！';
                    setTimeout(function(){
                        animateFinal(zheceng,{zIndex:2,opacity:0.5},function(){
                            animateFinal(tanchuang,{zIndex:5,opacity:1,top:'150px'})
                        });
                        clearInterval(timeID);
                        return;
                    },200)
                }

            }else if(e.button ==0){//鼠标单击的时候、

                // 第一次点击的时候生成所有的雷
                if(firstClick){
                    for(var i = 0;bool;i++){
                        abc = true;
                        var a =Math.floor(Math.random()*600);
                        for(var j = 0;j<arr.length;j++){
                            if(arr[j] ==a || a == this.index){
                                abc=false;
                                break;
                            }
                        }
                        if(abc == true){
                            arr.push(a);
                        }
                        if(arr.length==lave){
                            bool =false;
                        }
                    }
                    firstClick = false;
                }
                // 标记所有的雷
                for(var i = 0;i<arr.length;i++){
                    lis[arr[i]].aaa = 1;
                }
                // 计算所有非雷的格子周围所有的雷的数量
                for(var i = 0;i<lis.length;i++){
                    (function(){
                        if(lis[i].aaa){
                            return;
                        }else{
                            if(i==0){
                                if(lis[1].aaa){
                                    num2++;
                                }
                                if(lis[30].aaa){
                                    num2++;
                                }
                                if(lis[31].aaa){
                                    num2++;
                                }
                                if(num2==0){
                                    lis[i].bbb="";
                                }else{
                                    lis[i].bbb=num2;
                                    num2 =0;
                                }
                            }
                            else if(i>0&&i<29){
                                if(lis[i-1].aaa){
                                    num2++;
                                }
                                if(lis[i+1].aaa){
                                    num2++;
                                }
                                if(lis[i+29].aaa){
                                    num2++;
                                }
                                if(lis[i+30].aaa){
                                    num2++;
                                }
                                if(lis[i+31].aaa){
                                    num2++;
                                }
                                if(num2==0){
                                    lis[i].bbb="";
                                }else{
                                    lis[i].bbb=num2;
                                    num2 =0;
                                }
                            }
                            else if(i==29){
                                if(lis[i-1].aaa){
                                    num2++;
                                }
                                if(lis[i+30].aaa){
                                    num2++;
                                }
                                if(lis[i+29].aaa){
                                    num2++;
                                }
                                if(num2==0){
                                    lis[i].bbb="";
                                }else{
                                    lis[i].bbb=num2;
                                    num2 =0;
                                }
                            }
                            else if(indexArr1.indexOf(i)>=0){
                                if(lis[i-30].aaa){
                                    num2++;
                                }
                                if(lis[i-29].aaa){
                                    num2++;
                                }
                                if(lis[i+1].aaa){
                                    num2++;
                                }
                                if(lis[i+30].aaa){
                                    num2++;
                                }
                                if(lis[i+31].aaa){
                                    num2++;
                                }
                                if(num2==0){
                                    lis[i].bbb="";
                                }else{
                                    lis[i].bbb=num2;
                                    num2 =0;
                                }
                            }
                            else if(i == 570){
                                if(lis[i-30].aaa){
                                    num2++;
                                }
                                if(lis[i-29].aaa){
                                    num2++;
                                }
                                if(lis[i+1].aaa){
                                    num2++;
                                }
                                if(num2==0){
                                    lis[i].bbb="";
                                }else{
                                    lis[i].bbb=num2;
                                    num2 =0;
                                }
                            }
                            else if(i == 599){
                                if(lis[i-30].aaa){
                                    num2++;
                                }
                                if(lis[i-31].aaa){
                                    num2++;
                                }
                                if(lis[i-1].aaa){
                                    num2++;
                                }
                                if(num2==0){
                                    lis[i].bbb="";
                                }else{
                                    lis[i].bbb=num2;
                                    num2 =0;
                                }
                            }
                            else if(indexArr2.indexOf(i)>=0){
                                if(lis[i-30].aaa){
                                    num2++;
                                }
                                if(lis[i-31].aaa){
                                    num2++;
                                }
                                if(lis[i-1].aaa){
                                    num2++;
                                }
                                if(lis[i+30].aaa){
                                    num2++;
                                }
                                if(lis[i+29].aaa){
                                    num2++;
                                }
                                if(num2==0){
                                    lis[i].bbb="";
                                }else{
                                    lis[i].bbb=num2;
                                    num2 =0;
                                }
                            }
                            else if(i>570 &&i<599){
                                if(lis[i-1].aaa){
                                    num2++;
                                }
                                if(lis[i+1].aaa){
                                    num2++;
                                }
                                if(lis[i-31].aaa){
                                    num2++;
                                }
                                if(lis[i-30].aaa){
                                    num2++;
                                }
                                if(lis[i-29].aaa){
                                    num2++;
                                }
                                if(num2==0){
                                    lis[i].bbb="";
                                }else{
                                    lis[i].bbb=num2;
                                    num2 =0;
                                }
                            }
                            else {
                                if (lis[i - 29].aaa) {
                                    num2++;
                                }
                                if (lis[i - 30].aaa) {
                                    num2++;
                                }
                                if (lis[i - 31].aaa) {
                                    num2++;
                                }
                                if (lis[i - 1].aaa) {
                                    num2++;
                                }
                                if (lis[i + 1].aaa) {
                                    num2++;
                                }
                                if (lis[i + 31].aaa) {
                                    num2++;
                                }
                                if (lis[i + 30].aaa) {
                                    num2++;
                                }
                                if (lis[i + 29].aaa) {
                                    num2++;
                                }
                                if (num2 == 0) {
                                    lis[i].bbb = "";
                                } else {
                                    lis[i].bbb = num2;
                                    num2 = 0;
                                }
                            }
                        }
                    })()
                }
                // 当鼠标开始点击的时候，游戏开始，计时器开始计时
                if(!timeID){
                    timeID =setInterval(function (){
                        times++;
                        timeUse.innerHTML = times;
                    },1000)
                }
                // 如果当前格子已经右击标记，则左击不起效果
                if(!this.ccc){
                    return;
                }
                // 如果当前格子,判断周围所有的雷是不是都被正确的标示，如果是，就让周围其他不是雷的格子显示出来
                if(!this.ddd){
                    var booler1 = true;//这个变量表示周围所有的雷都正确的标示出来的状态；
                    var shu = 0;
                    (function(i){
                        if(i==0){
                            if(!lis[1].ccc){
                                shu++;
                            }
                            if(lis[1].aaa){
                                if(lis[1].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[1].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[30].ccc){
                                shu++;
                            }
                            if(lis[30].aaa){
                                if(lis[30].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[30].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[31].ccc){
                                shu++;
                            }
                            if(lis[31].aaa){
                                if(lis[31].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[31].ccc){
                                    booler1 =false;
                                }
                            }
                        }
                        else if(i>0&&i<29){
                            if(!lis[i-1].ccc){
                                shu++;
                            }
                            if(lis[i-1].aaa){
                                if(lis[i-1].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i-1].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i+1].ccc){
                                shu++;
                            }
                            if(lis[i+1].aaa){
                                if(lis[i+1].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i+1].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i+29].ccc){
                                shu++;
                            }
                            if(lis[i+29].aaa){
                                if(lis[i+29].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i+29].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i+30].ccc){
                                shu++;
                            }
                            if(lis[i+30].aaa){
                                if(lis[i+30].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i+30].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i+31].ccc){
                                shu++;
                            }
                            if(lis[i+31].aaa){
                                if(lis[i+31].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i+31].ccc){
                                    booler1 =false;
                                }
                            }
                        }
                        else if(i==29){
                            if(!lis[i-1].ccc){
                                shu++;
                            }
                            if(lis[i-1].aaa){
                                if(lis[i-1].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i-1].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i+30].ccc){
                                shu++;
                            }
                            if(lis[i+30].aaa){
                                if(lis[i+30].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i+30].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i+29].ccc){
                                shu++;
                            }
                            if(lis[i+29].aaa){
                                if(lis[i+29].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i+29].ccc){
                                    booler1 =false;
                                }
                            }
                        }
                        else if(indexArr1.indexOf(i)>=0){
                            if(!lis[i-30].ccc){
                                shu++;
                            }
                            if(lis[i-30].aaa){
                                if(lis[i-30].ccc){
                                    booler1 =false
                                    return;
                                }
                            }else{
                                if(!lis[i-30].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i-29].ccc){
                                shu++;
                            }
                            if(lis[i-29].aaa){
                                if(lis[i-29].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i-29].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i+1].ccc){
                                shu++;
                            }
                            if(lis[i+1].aaa){
                                if(lis[i+1].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i+1].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i+30].ccc){
                                shu++;
                            }
                            if(lis[i+30].aaa){
                                if(lis[i+30].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i+30].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i+31].ccc){
                                shu++;
                            }
                            if(lis[i+31].aaa){
                                if(lis[i+31].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i+31].ccc){
                                    booler1 =false;
                                }
                            }
                        }
                        else if(i == 570){
                            if(!lis[i-30].ccc){
                                shu++;
                            }
                            if(lis[i-30].aaa){
                                if(lis[i-30].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i-30].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i-29].ccc){
                                shu++;
                            }
                            if(lis[i-29].aaa){
                                if(lis[i-29].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i-29].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i+1].ccc){
                                shu++;
                            }
                            if(lis[i+1].aaa){
                                if(lis[i+1].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i+1].ccc){
                                    booler1 =false;
                                }
                            }
                        }
                        else if(i == 599){
                            if(!lis[i-30].ccc){
                                shu++;
                            }
                            if(lis[i-30].aaa){
                                if(lis[i-30].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i-30].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i-31].ccc){
                                shu++;
                            }
                            if(lis[i-31].aaa){
                                if(lis[i-31].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i-31].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i-1].ccc){
                                shu++;
                            }
                            if(lis[i-1].aaa){
                                if(lis[i-1].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i-1].ccc){
                                    booler1 =false;
                                }
                            }
                        }
                        else if(indexArr2.indexOf(i)>=0){
                            if(!lis[i-30].ccc){
                                shu++;
                            }
                            if(lis[i-30].aaa){
                                if(lis[i-30].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i-30].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i-31].ccc){
                                shu++;
                            }
                            if(lis[i-31].aaa){
                                if(lis[i-31].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i-31].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i-1].ccc){
                                shu++;
                            }
                            if(lis[i-1].aaa){
                                if(lis[i-1].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i-1].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i+30].ccc){
                                shu++;
                            }
                            if(lis[i+30].aaa){
                                if(lis[i+30].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i+30].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i+29].ccc){
                                shu++;
                            }
                            if(lis[i+29].aaa){
                                if(lis[i+29].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i+29].ccc){
                                    booler1 =false;
                                }
                            }
                        }
                        else if(i>570 &&i<599){
                            if(!lis[i-1].ccc){
                                shu++;
                            }
                            if(lis[i-1].aaa){
                                if(lis[i-1].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i-1].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i+1].ccc){
                                shu++;
                            }
                            if(lis[i+1].aaa){
                                if(lis[i+1].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i+1].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i-31].ccc){
                                shu++;
                            }
                            if(lis[i-31].aaa){
                                if(lis[i-31].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i-31].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i-30].ccc){
                                shu++;
                            }
                            if(lis[i-30].aaa){
                                if(lis[i-30].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i-30].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i-29].ccc){
                                shu++;
                            }
                            if(lis[i-29].aaa){
                                if(lis[i-29].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i-29].ccc){
                                    booler1 =false;
                                }
                            }
                        }
                        else {
                            if(!lis[i-29].ccc){
                                shu++;
                            }
                            if (lis[i - 29].aaa) {
                                if(lis[i - 29].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i - 29].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i-30].ccc){
                                shu++;
                            }
                            if (lis[i - 30].aaa) {
                                if(lis[i - 30].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i - 30].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i-31].ccc){
                                shu++;
                            }
                            if (lis[i - 31].aaa) {
                                if(lis[i - 31].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i - 31].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i-1].ccc){
                                shu++;
                            }
                            if (lis[i - 1].aaa) {
                                if(lis[i - 1].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i - 1].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i +1].ccc){
                                shu++;
                            }
                            if (lis[i + 1].aaa) {
                                if(lis[i + 1].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i + 1].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i +31].ccc){
                                shu++;
                            }
                            if (lis[i + 31].aaa) {
                                if(lis[i + 31].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i + 31].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i +30].ccc){
                                shu++;
                            }
                            if (lis[i + 30].aaa) {
                                if(lis[i + 30].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i + 30].ccc){
                                    booler1 =false;
                                }
                            }

                            if(!lis[i +29].ccc){
                                shu++;
                            }
                            if (lis[i + 29].aaa) {
                                if(lis[i + 29].ccc){
                                    booler1 =false;
                                }
                            }else{
                                if(!lis[i + 29].ccc){
                                    booler1 =false;
                                }
                            }
                        }
                    })(this.index)
                    if(booler1){//当周围的雷都标记出来了，并且标记对了，就让周围的格子都显示出来
                        isSpanc(this.index);
                        return;
                    }
                    if(shu == this.bbb){
                        tishi.innerHTML = '很遗憾，你输了！';
                        animateFinal(zheceng,{zIndex:2,opacity:0.5},function(){
                            animateFinal(tanchuang,{zIndex:5,opacity:1,top:'150px'})
                        });
                        return;
                    }
                }
                // 如果当前格子是雷，游戏结束，页面刷新重新渲染
                if(this.aaa){
                    tishi.innerHTML = '很遗憾，你输了！';
                    animateFinal(zheceng,{zIndex:2,opacity:0.5},function(){
                        animateFinal(tanchuang,{zIndex:5,opacity:1,top:'150px'})
                    });
                    return;
                }
                //  自定义属性ddd表示当前格子是否被左击的状态
                this.ddd = false;
                this.innerHTML = this.bbb;
                this.style.backgroundColor  = '#fff';
                // 如果当前格子是空的，则表示周围没有雷，就让它周围的所有格子都显示出来，并且判断周围的格子的每一个是不是空的
                if(!this.bbb){
                    isSpanc(this.index);
                }
            }
        }
    }
    function hehe(a){
        if(!lis[a].ddd){
            return;
        }
        if(!lis[a].aaa){
            lis[a].style.backgroundColor  = '#fff';
            lis[a].innerHTML  = lis[a].bbb;
            lis[a].ddd=false;
        }else{
            return;
        }
        if(!lis[a].bbb){
            isSpanc(a);
        }
    }
    function isSpanc(a){
        if(a==0){
            hehe(1);
            hehe(30);
            hehe(31);
        }
        else if(a>0&&a<29){
            hehe(a-1);
            hehe(a+1);
            hehe(a+29);
            hehe(a+30);
            hehe(a+31);
        }
        else if(a==29){
            hehe(a-1);
            hehe(a+30);
            hehe(a+29);
        }
        else if(indexArr1.indexOf(a)>=0){
            hehe(a-30);
            hehe(a-29);
            hehe(a+1);
            hehe(a+30);
            hehe(a+31);
        }
        else if(a == 570){
            hehe(a-30);
            hehe(a-29);
            hehe(a+1);
        }
        else if(a == 599){
            hehe(a-30);
            hehe(a-31);
            hehe(a-1);
        }
        else if(indexArr2.indexOf(a)>=0){
            hehe(a-30);
            hehe(a-31);
            hehe(a-1);
            hehe(a+30);
            hehe(a+29);
        }
        else if(a>570 &&a<599){
            hehe(a-1);
            hehe(a+1);
            hehe(a-31);
            hehe(a-30);
            hehe(a-29);
        }
        else {
            hehe(a-29);
            hehe(a-30);
            hehe(a-31);
            hehe(a-1);
            hehe(a+ 1);
            hehe(a+ 31);
            hehe(a+ 30);
            hehe(a+29);
        }
    }
    function animateFinal(element,obj,callback){
        clearInterval(element.timerId);
        element.timerId = setInterval(function(){
            var tiaojian = true;
            for(var key in obj){
                // 如果key是opacity
                if(key=="opacity"){
                    var current = parseFloat(getStyle(element,key))*100;
                    var target = parseFloat(obj[key])*100;
                    var step = (target-current)/10;
                    step = step>0? Math.ceil(step):Math.floor(step);
                    current+=step;
                    element.style[key] = current/100;
                    if(target !=current){
                        tiaojian = false;
                    }
                    // 如果key是z-index
                }else if(key=="zIndex"){
                    element.style[key] = obj[key];
                }else if(key=="display"){
                    element.style[key] = obj[key];
                }else{
                    // 如果key是以px结尾的属性
                    var current = parseFloat(getStyle(element,key));
                    var target = parseFloat(obj[key]);
                    var step = (target-current)/10;
                    step = step>0? Math.ceil(step):Math.floor(step);
                    current+=step;
                    element.style[key] = current+'px';
                    if(target !=current){
                        tiaojian = false;
                    }
                }
            }
            if(tiaojian){
                clearInterval(element.timerId);
                callback&&callback();
            }
        },20)
    }

    //  封装获取某个元素指定属性值的兼容函数
    function getStyle(element,attr){
        //如果浏览器支持这个方法，就返回通过这个方法获取的值
        if(window.getComputedStyle){
            return window.getComputedStyle(element,null)[attr];
        }else{
            //  如果浏览器支持这个方法，就返回通过这个方法获取的值
            return element.currentStyle[attr];
        }
    }

    // 封装通过id获取某个元素的函数
    function $id(id){
        return document.getElementById(id);
    }
</script>
</html>